# .github/workflows/backend-fastapi.yml
name: 🚀 Deploy FastAPI Backend to Render
on:
  push:
    branches: [main]
    paths: ['backend-fastapi/**']
jobs:
  deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
    steps:
      - name: 🚀 Trigger Render Deploy
        run: |
          RESPONSE=$(curl -s -w "%%{http_code}" -X POST \
            -H "Content-Type: application/json" \
            ${{ secrets.RENDER_DEPLOY_HOOK }} \
            -d '{"clearCache": true}')
          echo "Render response: $RESPONSE"
          if [[ $RESPONSE == 200* ]]; then
            echo "✅ Render deploy triggered!"
          else
            echo "❌ Render deploy failed: $RESPONSE"
            exit 1
          fi